# Score Log - スコア推移記録

## 概要

パフォーマンス改善の進捗を記録するためのログです。

---

## スコア記録

| 日時 | スコア | 成功 | 失敗 | 改善内容 | 備考 |
|------|--------|------|------|----------|------|
| 2026-02-07 | 0 | 172 | 37 | 初期状態（PHP実装） | タイムアウト多発 |

---

## 最新ベンチマーク結果

```json
{
  "pass": true,
  "score": 0,
  "success": 172,
  "fail": 37,
  "messages": [
    "リクエストがタイムアウトしました (GET /)",
    "リクエストがタイムアウトしました (GET /@summer)",
    "リクエストがタイムアウトしました (GET /image/10001.jpg)",
    "リクエストがタイムアウトしました (GET /image/7251.jpg)",
    "リクエストがタイムアウトしました (POST /login)",
    "リクエストがタイムアウトしました (POST /register)"
  ]
}
```

### 分析

- **pass: true** - ベンチマークは合格
- **score: 0** - タイムアウトが多くスコアが0
- **success: 172** - 172リクエストが成功
- **fail: 37** - 37リクエストがタイムアウト

### 主なボトルネック

1. **GET /** - トップページのタイムアウト（N+1クエリが原因と推測）
2. **GET /image/** - 画像取得のタイムアウト（DBからのBLOB読み込みが原因）
3. **POST /login, /register** - 認証処理のタイムアウト

---

## 目標スコア

| レベル | スコア | 状態 |
|--------|--------|------|
| 初期状態 | 0 | ✅ 計測完了 |
| 基本最適化 | 1,000+ | ⬜ |
| 中級 | 5,000+ | ⬜ |
| 上級 | 10,000+ | ⬜ |

---

## 改善履歴

### 2026-02-07: PHP実装に切り替え・初期計測

**変更内容:**
- Docker Composeの`context`を`ruby/`から`php/`に変更
- Nginx設定を`php.conf`に切り替え

**結果:**
- スコア: 0
- 成功: 172
- 失敗: 37
- 多数のタイムアウトエラー

---

## 次のアクション

1. [x] 初期スコアを計測
2. [ ] インデックスを追加（commentsテーブル、postsテーブル）
3. [ ] N+1クエリを解消
4. [ ] 画像をファイルシステムに移行

---

## 計測コマンド

```bash
docker run --network host -i \
  -v /Users/mei/PRTIMES/Iscogram/benchmarker/userdata:/opt/userdata \
  private-isu-benchmarker \
  /bin/benchmarker -t http://host.docker.internal -u /opt/userdata
```
